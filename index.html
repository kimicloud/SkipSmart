<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkipSmart - Smart Attendance Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f7fa;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: #434E78;
            margin-bottom: 40px;
            padding: 30px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 4px 15px rgba(67, 78, 120, 0.1);
        }

        header h1 {
            font-size: 3.5rem;
            font-weight: 800;
            margin-bottom: 10px;
            color: #434E78;
        }

        .tagline {
            font-size: 1.3rem;
            color: #607B8F;
            font-weight: 500;
        }

        .skip-calculator {
            background: white;
            border-radius: 20px;
            padding: 35px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(67, 78, 120, 0.1);
            border-left: 5px solid #E97F4A;
        }

        .skip-calculator h2 {
            color: #434E78;
            margin-bottom: 20px;
            font-size: 2rem;
        }

        .skip-result {
            background: #FFF9F0;
            border-radius: 15px;
            padding: 30px;
            min-height: 150px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border: 2px solid #F7E396;
        }

        .hint {
            color: #607B8F;
            font-size: 1.2rem;
            font-weight: 500;
        }

        .current-percentage {
            font-size: 3.5rem;
            font-weight: 800;
            margin-bottom: 10px;
        }

        .skip-info {
            font-size: 1.3rem;
            margin: 10px 0;
            font-weight: 600;
            color: #434E78;
        }

        .safe-skips {
            font-size: 1.6rem;
            font-weight: 700;
            margin: 15px 0;
            padding: 12px 25px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            color: #434E78;
        }

        .status-indicator {
            display: inline-block;
            padding: 12px 30px;
            border-radius: 30px;
            font-weight: 700;
            font-size: 1.2rem;
            margin-top: 15px;
        }

        .status-safe {
            background: #D4EDDA;
            color: #155724;
        }

        .status-caution {
            background: #F7E396;
            color: #856404;
        }

        .status-danger {
            background: #F8D7DA;
            color: #721C24;
        }

        .overall-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(67, 78, 120, 0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card:nth-child(1) { border-top: 4px solid #434E78; }
        .stat-card:nth-child(2) { border-top: 4px solid #E97F4A; }
        .stat-card:nth-child(3) { border-top: 4px solid #607B8F; }

        .stat-value {
            font-size: 3rem;
            font-weight: 800;
            color: #434E78;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #607B8F;
            font-size: 1.05rem;
            font-weight: 600;
        }

        .add-subject-btn {
            width: 100%;
            padding: 18px;
            background: #E97F4A;
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 1.3rem;
            font-weight: 700;
            cursor: pointer;
            margin-bottom: 30px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(233, 127, 74, 0.3);
        }

        .add-subject-btn:hover {
            background: #d66d38;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(233, 127, 74, 0.4);
        }

        .subjects-section h2 {
            color: #434E78;
            margin-bottom: 25px;
            font-size: 2rem;
            font-weight: 700;
        }

        .subjects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .subject-card {
            background: white;
            border-radius: 15px;
            padding: 28px;
            box-shadow: 0 4px 15px rgba(67, 78, 120, 0.1);
            transition: all 0.3s ease;
            border-left: 5px solid #607B8F;
        }

        .subject-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(67, 78, 120, 0.15);
        }

        .subject-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .subject-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: #434E78;
        }

        .delete-subject {
            background: #E97F4A;
            border: none;
            color: white;
            font-size: 1.4rem;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .delete-subject:hover {
            background: #d66d38;
        }

        .attendance-info {
            margin-bottom: 20px;
        }

        .attendance-fraction {
            font-size: 1.15rem;
            color: #607B8F;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .attendance-percentage {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 12px;
        }

        .streak-badge {
            display: inline-block;
            background: #F7E396;
            color: #856404;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.95rem;
            margin: 10px 0;
        }

        .streak-badge::before {
            content: 'üî• ';
        }

        .skip-counter {
            background: #FFF9F0;
            padding: 12px;
            border-radius: 10px;
            margin: 10px 0;
            font-weight: 600;
            color: #434E78;
            border: 2px solid #F7E396;
        }

        .skip-counter::before {
            content: '‚è≠Ô∏è ';
        }

        .skip-budget {
            background: #E8F4F8;
            padding: 12px;
            border-radius: 10px;
            margin: 10px 0;
            font-weight: 600;
            color: #434E78;
            border: 2px solid #607B8F;
        }

        .skip-budget::before {
            content: 'üéØ ';
        }

        .skip-budget-card {
            background: white;
            border: 2px solid #E8F4F8;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            display: flex;
            align-items: center;
            gap: 20px;
            box-shadow: 0 2px 8px rgba(67, 78, 120, 0.08);
        }

        .skip-budget-main {
            text-align: center;
            flex: 1;
        }

        .skip-budget-number {
            font-size: 3rem;
            font-weight: 800;
            line-height: 1;
            margin-bottom: 8px;
        }

        .skip-budget-label {
            font-size: 1rem;
            font-weight: 700;
            color: #434E78;
        }

        .skip-budget-used {
            text-align: center;
            flex: 1;
            padding-left: 20px;
            border-left: 2px solid #F0F0F0;
        }

        .skip-used-number {
            font-size: 2rem;
            font-weight: 800;
            color: #607B8F;
            line-height: 1;
            margin-bottom: 8px;
        }

        .skip-used-label {
            font-size: 1rem;
            font-weight: 700;
            color: #607B8F;
        }

        .skip-budget-info {
            flex: 2;
            font-size: 0.9rem;
            color: #607B8F;
            font-weight: 600;
            text-align: center;
            padding-left: 20px;
            border-left: 2px solid #F0F0F0;
        }

        .subject-skip-result {
            background: #FFF9F0;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            border: 2px solid #F7E396;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .subject-skip-result .current-percentage {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .subject-skip-result .skip-info {
            font-size: 1rem;
            margin: 8px 0;
            font-weight: 600;
            color: #434E78;
        }

        .subject-skip-result .safe-skips {
            font-size: 1.2rem;
            font-weight: 700;
            margin: 10px 0;
            padding: 8px 15px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            color: #434E78;
        }

        .subject-skip-result .status-indicator {
            display: inline-block;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 1rem;
            margin-top: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 14px;
            background: #F0F0F0;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 18px;
        }

        .progress-fill {
            height: 100%;
            transition: width 0.4s ease;
            border-radius: 10px;
        }

        .risk-safe { background: #28a745; }
        .risk-caution { background: #F7E396; }
        .risk-danger { background: #E97F4A; }

        .color-safe { color: #28a745; }
        .color-caution { color: #856404; }
        .color-danger { color: #E97F4A; }

        .class-notes {
            background: #F8F9FA;
            padding: 12px;
            border-radius: 10px;
            margin: 10px 0;
            font-size: 0.95rem;
            color: #607B8F;
            border-left: 4px solid #434E78;
            font-weight: 500;
        }

        .reminder-section {
            background: #FFF9F0;
            padding: 12px;
            border-radius: 10px;
            margin: 10px 0;
            font-size: 0.9rem;
            color: #434E78;
            border: 2px solid #F7E396;
            font-weight: 600;
        }

        .subject-actions {
            display: flex;
            gap: 12px;
        }

        .attendance-marking-section {
            background: #F8F9FA;
            border-radius: 12px;
            padding: 18px;
            margin: 15px 0;
            border: 2px solid #E8F4F8;
        }

        .attendance-marking-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .marking-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: #434E78;
        }

        .btn-small {
            padding: 10px 18px;
            font-size: 0.95rem;
        }

        .attendance-counters {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        .counter-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .counter-btn {
            padding: 18px;
            border: 2px solid;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
        }

        .present-counter {
            background: white;
            border-color: #28a745;
            color: #28a745;
        }

        .present-counter:hover {
            background: #28a745;
            color: white;
            transform: translateY(-2px);
        }

        .absent-counter {
            background: white;
            border-color: #E97F4A;
            color: #E97F4A;
        }

        .absent-counter:hover {
            background: #E97F4A;
            color: white;
            transform: translateY(-2px);
        }

        .counter-icon {
            font-size: 1.5rem;
        }

        .counter-label {
            font-size: 1rem;
        }

        .counter-display {
            text-align: center;
            padding: 12px;
            border-radius: 8px;
            font-size: 1.8rem;
            font-weight: 800;
        }

        .present-display {
            background: #D4EDDA;
            color: #155724;
        }

        .absent-display {
            background: #F8D7DA;
            color: #721C24;
        }

        .confirm-attendance-btn {
            width: 100%;
            padding: 14px;
            background: #434E78;
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.05rem;
        }

        .confirm-attendance-btn:hover:not(:disabled) {
            background: #35405f;
            transform: translateY(-2px);
        }

        .confirm-attendance-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .btn-primary {
            background: #434E78;
            color: white;
        }

        .btn-primary:hover {
            background: #35405f;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #E97F4A;
            color: white;
        }

        .btn-secondary:hover {
            background: #d66d38;
            transform: translateY(-2px);
        }

        .analytics-section {
            background: white;
            border-radius: 20px;
            padding: 35px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(67, 78, 120, 0.1);
            border-left: 5px solid #607B8F;
        }

        .analytics-section h2 {
            color: #434E78;
            margin-bottom: 20px;
            font-size: 2rem;
        }

        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .analytics-card {
            background: #F8F9FA;
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #434E78;
        }

        .analytics-card h3 {
            color: #434E78;
            font-size: 1.1rem;
            margin-bottom: 10px;
        }

        .analytics-card .value {
            font-size: 2rem;
            font-weight: 800;
            color: #E97F4A;
        }

        .zone-dashboard {
            background: white;
            border-radius: 20px;
            padding: 35px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(67, 78, 120, 0.1);
        }

        .zone-dashboard h2 {
            color: #434E78;
            margin-bottom: 25px;
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
        }

        .zones-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .zone-card {
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .zone-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .zone-safe {
            background: linear-gradient(135deg, #D4EDDA 0%, #C3E6CB 100%);
            border: 3px solid #28a745;
        }

        .zone-caution {
            background: linear-gradient(135deg, #FFF3CD 0%, #F7E396 100%);
            border: 3px solid #ffc107;
        }

        .zone-danger {
            background: linear-gradient(135deg, #F8D7DA 0%, #F5C6CB 100%);
            border: 3px solid #E97F4A;
        }

        .zone-icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .zone-title {
            font-size: 1.4rem;
            font-weight: 800;
            color: #434E78;
            margin-bottom: 8px;
        }

        .zone-criteria {
            font-size: 1rem;
            color: #607B8F;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .zone-count {
            font-size: 3.5rem;
            font-weight: 800;
            color: #434E78;
            margin-bottom: 5px;
        }

        .zone-label {
            font-size: 1rem;
            color: #607B8F;
            font-weight: 600;
        }

        .zone-subjects {
            background: #F8F9FA;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .zone-section {
            margin-bottom: 20px;
        }

        .zone-section:last-child {
            margin-bottom: 0;
        }

        .zone-section-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: #434E78;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .zone-subject-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .zone-subject-tag {
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .zone-subject-tag:hover {
            transform: scale(1.05);
        }

        .tag-safe {
            background: #D4EDDA;
            color: #155724;
            border: 2px solid #28a745;
        }

        .tag-caution {
            background: #FFF3CD;
            color: #856404;
            border: 2px solid #ffc107;
        }

        .tag-danger {
            background: #F8D7DA;
            color: #721C24;
            border: 2px solid #E97F4A;
        }

        .zone-empty {
            text-align: center;
            color: #607B8F;
            font-style: italic;
            padding: 10px;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(67, 78, 120, 0.5);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            margin: 8% auto;
            padding: 35px;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 40px rgba(67, 78, 120, 0.3);
        }

        .close {
            color: #E97F4A;
            float: right;
            font-size: 32px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .close:hover {
            color: #d66d38;
        }

        .modal-content h2 {
            margin-bottom: 25px;
            color: #434E78;
            font-weight: 700;
            font-size: 1.8rem;
        }

        .modal-content form {
            display: flex;
            flex-direction: column;
            gap: 18px;
        }

        .modal-content input {
            padding: 15px;
            border: 2px solid #F0F0F0;
            border-radius: 10px;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .modal-content input:focus {
            outline: none;
            border-color: #607B8F;
        }

        .modal-content button[type="submit"] {
            padding: 15px;
            background: #E97F4A;
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .modal-content button[type="submit"]:hover {
            background: #d66d38;
        }

        .attendance-buttons {
            display: flex;
            gap: 18px;
            margin-bottom: 20px;
        }

        .attendance-summary {
            background: #F8F9FA;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-around;
            gap: 20px;
        }

        .summary-item {
            text-align: center;
            flex: 1;
        }

        .summary-label {
            display: block;
            font-size: 1rem;
            color: #607B8F;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .summary-value {
            display: block;
            font-size: 2.5rem;
            font-weight: 800;
            color: #434E78;
        }

        .modal-actions {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .confirm-btn {
            width: 100%;
            padding: 18px;
            background: #434E78;
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.2rem;
        }

        .confirm-btn:hover {
            background: #35405f;
            transform: translateY(-2px);
        }

        .confirm-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .present-btn, .absent-btn {
            flex: 1;
            padding: 25px;
            border: none;
            border-radius: 15px;
            font-size: 1.3rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .btn-icon {
            font-size: 2rem;
        }

        .btn-text {
            font-size: 1.3rem;
        }

        .btn-count {
            font-size: 1.5rem;
            font-weight: 800;
            opacity: 0.9;
        }

        .present-btn {
            background: #28a745;
            color: white;
        }

        .present-btn:hover {
            background: #218838;
            transform: scale(1.02);
        }

        .absent-btn {
            background: #E97F4A;
            color: white;
        }

        .absent-btn:hover {
            background: #d66d38;
            transform: scale(1.02);
        }

        .undo-btn {
            width: 100%;
            padding: 14px;
            background: #607B8F;
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.05rem;
        }

        .undo-btn:hover {
            background: #4e6477;
        }

        footer {
            text-align: center;
            color: #607B8F;
            padding: 35px;
            font-size: 1.05rem;
            font-weight: 500;
        }

        .reminder-toggle {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(67, 78, 120, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .reminder-toggle label {
            font-size: 1.2rem;
            font-weight: 600;
            color: #434E78;
        }

        .toggle-switch {
            position: relative;
            width: 60px;
            height: 30px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 30px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #434E78;
        }

        input:checked + .slider:before {
            transform: translateX(30px);
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 2.5rem;
            }
            
            .subjects-grid {
                grid-template-columns: 1fr;
            }
            
            .overall-stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>SkipSmart</h1>
            <p class="tagline">Know if you can skip today in 3 seconds</p>
        </header>

        <div class="reminder-toggle">
            <label for="reminderToggle">üîî Enable Class Reminders</label>
            <label class="toggle-switch">
                <input type="checkbox" id="reminderToggle">
                <span class="slider"></span>
            </label>
        </div>

        <section class="skip-calculator">
            <h2>Can I Skip Today?</h2>
            <div class="skip-result" id="skipResult">
                <p class="hint">Select a subject below to check</p>
            </div>
        </section>

        <section class="overall-stats">
            <div class="stat-card">
                <div class="stat-value" id="overallPercentage">0%</div>
                <div class="stat-label">Overall Attendance</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalClasses">0</div>
                <div class="stat-label">Total Classes</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="attendedClasses">0</div>
                <div class="stat-label">Classes Attended</div>
            </div>
        </section>

        <section class="zone-dashboard">
            <h2>üìä Attendance Zones Overview</h2>
            <div class="zones-grid">
                <div class="zone-card zone-safe">
                    <div class="zone-icon">üü¢</div>
                    <div class="zone-title">Safe Zone</div>
                    <div class="zone-criteria">‚â•80% attendance</div>
                    <div class="zone-count" id="safeZoneCount">0</div>
                    <div class="zone-label">subjects</div>
                </div>
                <div class="zone-card zone-caution">
                    <div class="zone-icon">üü°</div>
                    <div class="zone-title">Caution Zone</div>
                    <div class="zone-criteria">75-79% attendance</div>
                    <div class="zone-count" id="cautionZoneCount">0</div>
                    <div class="zone-label">subjects</div>
                </div>
                <div class="zone-card zone-danger">
                    <div class="zone-icon">üî¥</div>
                    <div class="zone-title">Danger Zone</div>
                    <div class="zone-criteria">&lt;75% attendance</div>
                    <div class="zone-count" id="dangerZoneCount">0</div>
                    <div class="zone-label">subjects</div>
                </div>
            </div>
            <div class="zone-subjects" id="zoneSubjects"></div>
        </section>

        <section class="analytics-section" id="analyticsSection" style="display: none;">
            <h2>üìä Analytics Dashboard</h2>
            <div class="analytics-grid" id="analyticsGrid"></div>
        </section>

        <button class="add-subject-btn" id="addSubjectBtn">+ Add Subject</button>

        <section class="subjects-section">
            <h2>Your Subjects</h2>
            <div class="subjects-grid" id="subjectsGrid"></div>
        </section>

        <div class="modal" id="addSubjectModal">
            <div class="modal-content">
                <span class="close" id="closeAddModal">&times;</span>
                <h2>Add New Subject</h2>
                <form id="addSubjectForm">
                    <input type="text" id="subjectName" placeholder="Subject Name (e.g. Mathematics)" required>
                    <input type="number" id="totalClassesInput" placeholder="Total classes this semester (optional)" min="1">
                    <button type="submit">Add Subject</button>
                </form>
            </div>
        </div>

        <div class="modal" id="markAttendanceModal">
            <div class="modal-content">
                <span class="close" id="closeAttendanceModal">&times;</span>
                <h2 id="attendanceModalTitle">Mark Attendance</h2>
                
                <div class="attendance-summary">
                    <div class="summary-item">
                        <span class="summary-label">Present:</span>
                        <span class="summary-value" id="presentCount">0</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Absent:</span>
                        <span class="summary-value" id="absentCount">0</span>
                    </div>
                </div>
                
                <div class="attendance-buttons">
                    <button class="present-btn" id="markPresentBtn">
                        <span class="btn-icon">‚úì</span>
                        <span class="btn-text">Present</span>
                        <span class="btn-count">+1</span>
                    </button>
                    <button class="absent-btn" id="markAbsentBtn">
                        <span class="btn-icon">‚úï</span>
                        <span class="btn-text">Absent</span>
                        <span class="btn-count">-1</span>
                    </button>
                </div>
                
                <div class="modal-actions">
                    <button class="confirm-btn" id="confirmAttendanceBtn">‚úì Confirm & Save</button>
                    <button class="undo-btn" id="undoBtn">‚Ü∂ Undo Last Action</button>
                </div>
            </div>
        </div>

        <footer>
            <p>Made for students who value their attendance (and their sleep) üò¥</p>
        </footer>
    </div>

    <script>
        // Storage Manager
        const StorageManager = {
            getSubjects() {
                const data = localStorage.getItem('skipsmart_subjects');
                return data ? JSON.parse(data) : [];
            },

            saveSubjects(subjects) {
                localStorage.setItem('skipsmart_subjects', JSON.stringify(subjects));
            },

            addSubject(name, totalClassesInSemester = null) {
                const subjects = this.getSubjects();
                const newSubject = {
                    id: Date.now().toString(),
                    name: name,
                    attended: 0,
                    total: 0,
                    skipsUsed: 0,
                    currentStreak: 0,
                    bestStreak: 0,
                    lastAttendedDate: null,
                    totalClassesInSemester: totalClassesInSemester,
                    history: []
                };
                subjects.push(newSubject);
                this.saveSubjects(subjects);
                return newSubject;
            },

            deleteSubject(id) {
                let subjects = this.getSubjects();
                subjects = subjects.filter(s => s.id !== id);
                this.saveSubjects(subjects);
            },

            updateAttendance(id, isPresent) {
                const subjects = this.getSubjects();
                const subject = subjects.find(s => s.id === id);
                
                if (subject) {
                    subject.total++;
                    
                    if (isPresent) {
                        subject.attended++;
                        subject.currentStreak++;
                        subject.lastAttendedDate = new Date().toISOString();
                        
                        if (subject.currentStreak > subject.bestStreak) {
                            subject.bestStreak = subject.currentStreak;
                        }
                    } else {
                        subject.currentStreak = 0;
                        subject.skipsUsed++;
                    }
                    
                    subject.history.push({
                        date: new Date().toISOString(),
                        present: isPresent
                    });
                    
                    this.saveSubjects(subjects);
                    return subject;
                }
                return null;
            },

            undoLastAttendance(id) {
                const subjects = this.getSubjects();
                const subject = subjects.find(s => s.id === id);
                
                if (subject && subject.history.length > 0) {
                    const lastEntry = subject.history.pop();
                    subject.total--;
                    
                    if (lastEntry.present) {
                        subject.attended--;
                        subject.currentStreak = Math.max(0, subject.currentStreak - 1);
                    } else {
                        subject.skipsUsed = Math.max(0, subject.skipsUsed - 1);
                    }
                    
                    this.recalculateStreak(subject);
                    this.saveSubjects(subjects);
                    return subject;
                }
                return null;
            },

            recalculateStreak(subject) {
                if (subject.history.length === 0) {
                    subject.currentStreak = 0;
                    return;
                }

                let streak = 0;
                for (let i = subject.history.length - 1; i >= 0; i--) {
                    if (subject.history[i].present) {
                        streak++;
                    } else {
                        break;
                    }
                }
                subject.currentStreak = streak;
            },

            getSubject(id) {
                const subjects = this.getSubjects();
                return subjects.find(s => s.id === id);
            },

            getDaysSinceLastAttendance(lastAttendedDate) {
                if (!lastAttendedDate) return null;
                
                const lastDate = new Date(lastAttendedDate);
                const today = new Date();
                const diffTime = Math.abs(today - lastDate);
                const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
                
                return diffDays;
            },

            getRemindersEnabled() {
                return localStorage.getItem('skipsmart_reminders') === 'true';
            },

            setRemindersEnabled(enabled) {
                localStorage.setItem('skipsmart_reminders', enabled.toString());
            }
        };

        // Main App
        class SkipSmart {
            constructor() {
                this.currentSubjectId = null;
                this.pendingAttendance = {}; // Store pending changes per subject
                this.init();
            }

            init() {
                this.renderSubjects();
                this.updateOverallStats();
                this.updateZoneDashboard();
                this.updateAnalytics();
                this.setupEventListeners();
                this.loadReminderPreference();
                this.checkReminders();
            }

            setupEventListeners() {
                const addSubjectBtn = document.getElementById('addSubjectBtn');
                const addSubjectModal = document.getElementById('addSubjectModal');
                const addSubjectForm = document.getElementById('addSubjectForm');
                const closeAddModal = document.getElementById('closeAddModal');
                
                addSubjectBtn.addEventListener('click', () => {
                    addSubjectModal.style.display = 'block';
                });

                closeAddModal.addEventListener('click', () => {
                    addSubjectModal.style.display = 'none';
                });

                addSubjectForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const subjectName = document.getElementById('subjectName').value.trim();
                    const totalClasses = document.getElementById('totalClassesInput').value;
                    const totalClassesNum = totalClasses ? parseInt(totalClasses) : null;
                    
                    if (subjectName) {
                        StorageManager.addSubject(subjectName, totalClassesNum);
                        document.getElementById('subjectName').value = '';
                        document.getElementById('totalClassesInput').value = '';
                        addSubjectModal.style.display = 'none';
                        this.renderSubjects();
                        this.updateOverallStats();
                        this.updateZoneDashboard();
                        this.updateAnalytics();
                    }
                });

                const markAttendanceModal = document.getElementById('markAttendanceModal');
                const markPresentBtn = document.getElementById('markPresentBtn');
                const markAbsentBtn = document.getElementById('markAbsentBtn');
                const confirmAttendanceBtn = document.getElementById('confirmAttendanceBtn');
                const undoBtn = document.getElementById('undoBtn');
                const closeAttendanceModal = document.getElementById('closeAttendanceModal');

                markPresentBtn.addEventListener('click', () => {
                    this.pendingPresent++;
                    this.updateAttendanceSummary();
                });

                markAbsentBtn.addEventListener('click', () => {
                    this.pendingAbsent++;
                    this.updateAttendanceSummary();
                });

                confirmAttendanceBtn.addEventListener('click', () => {
                    this.confirmAttendance();
                });

                undoBtn.addEventListener('click', () => {
                    this.undoAttendance();
                });

                closeAttendanceModal.addEventListener('click', () => {
                    markAttendanceModal.style.display = 'none';
                });

                window.addEventListener('click', (e) => {
                    if (e.target.classList.contains('modal')) {
                        e.target.style.display = 'none';
                    }
                });

                const reminderToggle = document.getElementById('reminderToggle');
                reminderToggle.addEventListener('change', (e) => {
                    StorageManager.setRemindersEnabled(e.target.checked);
                    if (e.target.checked) {
                        this.requestNotificationPermission();
                    }
                });
            }

            loadReminderPreference() {
                const reminderToggle = document.getElementById('reminderToggle');
                reminderToggle.checked = StorageManager.getRemindersEnabled();
            }

            requestNotificationPermission() {
                if ('Notification' in window && Notification.permission === 'default') {
                    Notification.requestPermission().then(permission => {
                        if (permission === 'granted') {
                            new Notification('SkipSmart', {
                                body: 'Class reminders enabled! We\'ll notify you when attendance is low.',
                                icon: 'üîî'
                            });
                        }
                    });
                }
            }

            checkReminders() {
                if (!StorageManager.getRemindersEnabled()) return;
                if (!('Notification' in window) || Notification.permission !== 'granted') return;

                const subjects = StorageManager.getSubjects();
                subjects.forEach(subject => {
                    if (subject.total === 0) return;
                    
                    const percentage = (subject.attended / subject.total) * 100;
                    
                    if (percentage < 75) {
                        new Notification('‚ö†Ô∏è Low Attendance Alert!', {
                            body: `${subject.name}: ${percentage.toFixed(1)}% - You MUST attend the next class!`,
                            icon: 'üî¥'
                        });
                    } else if (percentage < 80) {
                        new Notification('üü° Attendance Warning', {
                            body: `${subject.name}: ${percentage.toFixed(1)}% - Be careful! Close to danger zone.`,
                            icon: 'üü°'
                        });
                    }
                });

                setTimeout(() => this.checkReminders(), 3600000);
            }

            renderSubjects() {
                const subjects = StorageManager.getSubjects();
                const grid = document.getElementById('subjectsGrid');
                
                // Initialize pending attendance for all subjects
                subjects.forEach(subject => {
                    if (!this.pendingAttendance[subject.id]) {
                        this.pendingAttendance[subject.id] = { present: 0, absent: 0 };
                    }
                });
                
                if (subjects.length === 0) {
                    grid.innerHTML = '<p style="color: #607B8F; text-align: center; grid-column: 1/-1; font-size: 1.2rem; padding: 40px;">No subjects yet. Click "+ Add Subject" to get started!</p>';
                    return;
                }
                
                grid.innerHTML = subjects.map(subject => {
                    const percentage = subject.total === 0 ? 0 : (subject.attended / subject.total) * 100;
                    const safeSkips = this.calculateSafeSkips(subject);
                    const riskLevel = this.getRiskLevel(percentage);
                    const daysSinceAttended = StorageManager.getDaysSinceLastAttendance(subject.lastAttendedDate);
                    
                    let reminderText = '';
                    if (daysSinceAttended !== null && daysSinceAttended > 3 && percentage < 80) {
                        reminderText = `<div class="reminder-section">‚è∞ ${daysSinceAttended} days since last attendance!</div>`;
                    }
                    
                    let semesterInfo = '';
                    let skipBudgetDisplay = '';
                    let skipResultDisplay = '';
                    
                    if (subject.totalClassesInSemester) {
                        const remaining = subject.totalClassesInSemester - subject.total;
                        const totalSkipsAllowed = Math.floor(subject.totalClassesInSemester * 0.25); // 25% can be skipped
                        const skipsRemaining = Math.max(0, totalSkipsAllowed - subject.skipsUsed);
                        
                        semesterInfo = `<div class="class-notes">üìÖ ${remaining} classes remaining this semester</div>`;
                        
                        let budgetColor = 'safe';
                        if (skipsRemaining <= 2) budgetColor = 'danger';
                        else if (skipsRemaining <= 5) budgetColor = 'caution';
                        
                        skipBudgetDisplay = `
                            <div class="skip-budget-card">
                                <div class="skip-budget-main">
                                    <div class="skip-budget-number color-${budgetColor}">${skipsRemaining}</div>
                                    <div class="skip-budget-label">Skips Left</div>
                                </div>
                                <div class="skip-budget-used">
                                    <div class="skip-used-number">${subject.skipsUsed}</div>
                                    <div class="skip-used-label">Used</div>
                                </div>
                                <div class="skip-budget-info">üìä Out of ${subject.totalClassesInSemester} classes ‚Ä¢ ${subject.total} attended</div>
                            </div>
                        `;
                    } else {
                        skipBudgetDisplay = `
                            <div class="skip-counter">Skips used: ${subject.skipsUsed}</div>
                            <div class="skip-budget">Safe skips: ${safeSkips}</div>
                        `;
                    }
                    
                    return `
                        <div class="subject-card">
                            <div class="subject-header">
                                <div class="subject-name">${subject.name}</div>
                                <button class="delete-subject" onclick="app.deleteSubject('${subject.id}')">‚úï</button>
                            </div>
                            
                            <div class="attendance-info">
                                <div class="attendance-fraction">${subject.attended}/${subject.total} classes</div>
                                <div class="attendance-percentage color-${riskLevel}">${percentage.toFixed(1)}%</div>
                                
                                <div class="progress-bar">
                                    <div class="progress-fill risk-${riskLevel}" style="width: ${percentage}%"></div>
                                </div>
                                
                                ${subject.currentStreak > 0 ? `<div class="streak-badge">${subject.currentStreak} day streak</div>` : ''}
                                ${subject.bestStreak > 0 ? `<div class="class-notes">üèÜ Best streak: ${subject.bestStreak} days</div>` : ''}
                                
                                ${skipBudgetDisplay}
                                
                                <div class="subject-skip-result" id="skipResult-${subject.id}" style="display: none;"></div>
                                
                                ${reminderText}
                                ${semesterInfo}
                            </div>
                            
                            <div class="attendance-marking-section">
                                <div class="attendance-marking-header">
                                    <span class="marking-title">Mark Attendance</span>
                                </div>
                                <div class="attendance-counters">
                                    <div class="counter-group">
                                        <button class="counter-btn present-counter" onclick="app.addPresent('${subject.id}')">
                                            <span class="counter-icon">‚úì</span>
                                            <span class="counter-label">Present</span>
                                        </button>
                                        <div class="counter-display present-display" id="presentDisplay-${subject.id}">0</div>
                                    </div>
                                    <div class="counter-group">
                                        <button class="counter-btn absent-counter" onclick="app.addAbsent('${subject.id}')">
                                            <span class="counter-icon">‚úï</span>
                                            <span class="counter-label">Absent</span>
                                        </button>
                                        <div class="counter-display absent-display" id="absentDisplay-${subject.id}">0</div>
                                    </div>
                                </div>
                                <button class="confirm-attendance-btn" id="confirmBtn-${subject.id}" onclick="app.confirmSubjectAttendance('${subject.id}')" disabled>
                                    ‚úì Save Changes
                                </button>
                            </div>
                            
                            <div class="subject-actions">
                                <button class="btn btn-primary" onclick="app.showSkipCalculator('${subject.id}')">Can I Skip?</button>
                                <button class="undo-btn" onclick="app.undoSubjectAttendance('${subject.id}')">‚Ü∂ Undo Last</button>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            addPresent(subjectId) {
                if (!this.pendingAttendance[subjectId]) {
                    this.pendingAttendance[subjectId] = { present: 0, absent: 0 };
                }
                this.pendingAttendance[subjectId].present++;
                this.updateSubjectCounters(subjectId);
            }

            addAbsent(subjectId) {
                if (!this.pendingAttendance[subjectId]) {
                    this.pendingAttendance[subjectId] = { present: 0, absent: 0 };
                }
                this.pendingAttendance[subjectId].absent++;
                this.updateSubjectCounters(subjectId);
            }

            updateSubjectCounters(subjectId) {
                const presentDisplay = document.getElementById(`presentDisplay-${subjectId}`);
                const absentDisplay = document.getElementById(`absentDisplay-${subjectId}`);
                const confirmBtn = document.getElementById(`confirmBtn-${subjectId}`);
                
                if (presentDisplay && absentDisplay && confirmBtn) {
                    presentDisplay.textContent = this.pendingAttendance[subjectId].present;
                    absentDisplay.textContent = this.pendingAttendance[subjectId].absent;
                    
                    const hasChanges = this.pendingAttendance[subjectId].present > 0 || 
                                      this.pendingAttendance[subjectId].absent > 0;
                    confirmBtn.disabled = !hasChanges;
                }
            }

            confirmSubjectAttendance(subjectId) {
                const pending = this.pendingAttendance[subjectId];
                if (!pending || (pending.present === 0 && pending.absent === 0)) return;
                
                for (let i = 0; i < pending.present; i++) {
                    StorageManager.updateAttendance(subjectId, true);
                }
                
                for (let i = 0; i < pending.absent; i++) {
                    StorageManager.updateAttendance(subjectId, false);
                }
                
                this.pendingAttendance[subjectId] = { present: 0, absent: 0 };
                
                this.renderSubjects();
                this.updateOverallStats();
                this.updateZoneDashboard();
                this.updateAnalytics();
            }

            undoSubjectAttendance(subjectId) {
                const subject = StorageManager.undoLastAttendance(subjectId);
                
                if (subject) {
                    this.renderSubjects();
                    this.updateOverallStats();
                    this.updateZoneDashboard();
                    this.updateAnalytics();
                } else {
                    alert('No attendance record to undo!');
                }
            }

            calculateSafeSkips(subject) {
                if (subject.total === 0) return 0;
                
                const currentPercentage = (subject.attended / subject.total) * 100;
                const targetPercentage = 75;
                
                if (currentPercentage < targetPercentage) return 0;
                
                let skips = 0;
                let tempAttended = subject.attended;
                let tempTotal = subject.total;
                
                while (tempTotal < 1000) {
                    const newPercentage = (tempAttended / (tempTotal + 1)) * 100;
                    if (newPercentage >= targetPercentage) {
                        skips++;
                        tempTotal++;
                    } else {
                        break;
                    }
                }
                
                return skips;
            }

            getRiskLevel(percentage) {
                if (percentage >= 80) return 'safe';
                if (percentage >= 75) return 'caution';
                return 'danger';
            }

            showSkipCalculator(subjectId) {
    const subject = StorageManager.getSubject(subjectId);
    if (!subject) return;
    
    // Get pending changes for this subject
    const pending = this.pendingAttendance[subjectId] || { present: 0, absent: 0 };
    
    // Calculate CURRENT attendance based on pending changes
    const currentAttended = subject.attended + pending.present;
    const currentTotal = subject.total + pending.present + pending.absent;
    const currentPercentage = currentTotal === 0 ? 0 : (currentAttended / currentTotal) * 100;
    
    // Calculate AFTER SKIPPING (add 1 absent to simulate skip)
    const afterSkipAttended = currentAttended; // Same, not attending
    const afterSkipTotal = currentTotal + 1; // One more class
    const afterSkipPercentage = (afterSkipAttended / afterSkipTotal) * 100;
    
    const afterSkipRiskLevel = this.getRiskLevel(afterSkipPercentage);
    
    // Calculate safe skips from CURRENT state
    let safeSkips = 0;
    if (currentTotal > 0) {
        const targetPercentage = 75;
        
        if (currentPercentage < targetPercentage) {
            safeSkips = 0;
        } else {
            let tempAttended = currentAttended;
            let tempTotal = currentTotal;
            
            while (tempTotal < 1000) {
                const newPercentage = (tempAttended / (tempTotal + 1)) * 100;
                if (newPercentage >= targetPercentage) {
                    safeSkips++;
                    tempTotal++;
                } else {
                    break;
                }
            }
        }
    }
    
    let statusClass = 'status-safe';
    let statusText = '‚úÖ Safe to Skip!';
    let advice = '';
    
    // Decision based on AFTER SKIP percentage
    if (afterSkipRiskLevel === 'danger') {
        statusClass = 'status-danger';
        statusText = 'üö´ DON\'T SKIP!';
        advice = `If you skip, your attendance will drop to <strong>${afterSkipPercentage.toFixed(1)}%</strong> (below 75%). You MUST attend!`;
        
        // Calculate classes needed to recover
        let classesNeeded = 0;
        let tempAttended = currentAttended;
        let tempTotal = currentTotal;
        
        while (tempTotal < 1000) {
            tempAttended++;
            tempTotal++;
            classesNeeded++;
            const newPercentage = (tempAttended / tempTotal) * 100;
            if (newPercentage >= 75) {
                break;
            }
        }
        
        advice += ` You need ${classesNeeded} consecutive classes to reach safe zone.`;
    } else if (afterSkipRiskLevel === 'caution') {
        statusClass = 'status-caution';
        statusText = '‚ö†Ô∏è Risky!';
        advice = `If you skip, your attendance will be <strong>${afterSkipPercentage.toFixed(1)}%</strong> (caution zone). `;
        if (safeSkips <= 1) {
            advice += `This is your last safe skip! Next skip will be dangerous.`;
        } else {
            advice += `You'll have ${safeSkips - 1} safe skip(s) left after this.`;
        }
    } else {
        statusClass = 'status-safe';
        statusText = '‚úÖ Safe to Skip!';
        advice = `If you skip, your attendance will be <strong>${afterSkipPercentage.toFixed(1)}%</strong> (still safe). `;
        advice += `You can skip ${safeSkips} more time(s) safely.`;
    }
    
    // Check if there are pending changes
    const hasPendingChanges = pending.present > 0 || pending.absent > 0;
    let pendingNote = '';
    
    if (hasPendingChanges) {
        pendingNote = `<div style="font-size: 0.85rem; color: #607B8F; font-style: italic; margin-top: 8px; padding-top: 8px; border-top: 1px dashed #E0E0E0;">
            üí° Calculated with pending changes: +${pending.present} present, -${pending.absent} absent
        </div>`;
    }
    
    const skipResultElement = document.getElementById(`skipResult-${subjectId}`);
    
    if (skipResultElement) {
        skipResultElement.innerHTML = `
            <div style="font-size: 1rem; color: #607B8F; font-weight: 600; margin-bottom: 10px;">
                Current: <span class="color-${this.getRiskLevel(currentPercentage)}" style="font-size: 1.3rem; font-weight: 800;">${currentPercentage.toFixed(1)}%</span>
            </div>
            <div style="font-size: 1.5rem; margin: 8px 0;">‚¨áÔ∏è</div>
            <div style="font-size: 1rem; color: #607B8F; font-weight: 600; margin-bottom: 8px;">After 1 Skip:</div>
            <div class="current-percentage color-${afterSkipRiskLevel}">${afterSkipPercentage.toFixed(1)}%</div>
            <div class="safe-skips">${safeSkips} safe skip(s) available now</div>
            <div class="skip-info" style="font-size: 0.95rem; text-align: center;">${advice}</div>
            <div class="status-indicator ${statusClass}">${statusText}</div>
            ${pendingNote}
        `;
        skipResultElement.style.display = 'block';
        
        skipResultElement.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }
}

            openAttendanceModal(subjectId) {
                // Legacy function - no longer used
            }

            updateAttendanceSummary() {
                // Legacy function - no longer used
            }

            confirmAttendance() {
                // Legacy function - no longer used
            }

            undoAttendance() {
                // Legacy function - no longer used
            }

            deleteSubject(subjectId) {
                if (confirm('Are you sure you want to delete this subject? This action cannot be undone.')) {
                    StorageManager.deleteSubject(subjectId);
                    this.renderSubjects();
                    this.updateOverallStats();
                    this.updateZoneDashboard();
                    this.updateAnalytics();
                }
            }

            updateZoneDashboard() {
                const subjects = StorageManager.getSubjects();
                
                let safeZone = [];
                let cautionZone = [];
                let dangerZone = [];
                
                subjects.forEach(subject => {
                    if (subject.total === 0) return;
                    
                    const percentage = (subject.attended / subject.total) * 100;
                    const subjectData = {
                        name: subject.name,
                        percentage: percentage.toFixed(1),
                        id: subject.id
                    };
                    
                    if (percentage >= 80) {
                        safeZone.push(subjectData);
                    } else if (percentage >= 75) {
                        cautionZone.push(subjectData);
                    } else {
                        dangerZone.push(subjectData);
                    }
                });
                
                document.getElementById('safeZoneCount').textContent = safeZone.length;
                document.getElementById('cautionZoneCount').textContent = cautionZone.length;
                document.getElementById('dangerZoneCount').textContent = dangerZone.length;
                
                const zoneSubjects = document.getElementById('zoneSubjects');
                
                if (subjects.length === 0 || subjects.every(s => s.total === 0)) {
                    zoneSubjects.innerHTML = '<div class="zone-empty">No subjects with attendance data yet.</div>';
                    return;
                }
                
                let zoneHTML = '';
                
                if (dangerZone.length > 0) {
                    zoneHTML += `
                        <div class="zone-section">
                            <div class="zone-section-title">
                                üî¥ Danger Zone - Immediate Attention Required
                            </div>
                            <div class="zone-subject-list">
                                ${dangerZone.map(s => `
                                    <div class="zone-subject-tag tag-danger" onclick="app.showSkipCalculator('${s.id}')">
                                        ${s.name} (${s.percentage}%)
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
                
                if (cautionZone.length > 0) {
                    zoneHTML += `
                        <div class="zone-section">
                            <div class="zone-section-title">
                                üü° Caution Zone - Be Careful
                            </div>
                            <div class="zone-subject-list">
                                ${cautionZone.map(s => `
                                    <div class="zone-subject-tag tag-caution" onclick="app.showSkipCalculator('${s.id}')">
                                        ${s.name} (${s.percentage}%)
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
                
                if (safeZone.length > 0) {
                    zoneHTML += `
                        <div class="zone-section">
                            <div class="zone-section-title">
                                üü¢ Safe Zone - You're Doing Great!
                            </div>
                            <div class="zone-subject-list">
                                ${safeZone.map(s => `
                                    <div class="zone-subject-tag tag-safe" onclick="app.showSkipCalculator('${s.id}')">
                                        ${s.name} (${s.percentage}%)
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
                
                zoneSubjects.innerHTML = zoneHTML || '<div class="zone-empty">No subjects with attendance data yet.</div>';
            }

            updateOverallStats() {
                const subjects = StorageManager.getSubjects();
                
                let totalClasses = 0;
                let attendedClasses = 0;
                
                subjects.forEach(subject => {
                    totalClasses += subject.total;
                    attendedClasses += subject.attended;
                });
                
                const overallPercentage = totalClasses === 0 ? 0 : (attendedClasses / totalClasses) * 100;
                
                document.getElementById('overallPercentage').textContent = overallPercentage.toFixed(1) + '%';
                document.getElementById('totalClasses').textContent = totalClasses;
                document.getElementById('attendedClasses').textContent = attendedClasses;
            }

            updateAnalytics() {
                const subjects = StorageManager.getSubjects();
                
                if (subjects.length === 0) {
                    document.getElementById('analyticsSection').style.display = 'none';
                    return;
                }
                
                document.getElementById('analyticsSection').style.display = 'block';
                
                const bestAttendance = subjects.reduce((best, s) => {
                    if (s.total === 0) return best;
                    const perc = (s.attended / s.total) * 100;
                    return perc > best.perc ? { name: s.name, perc } : best;
                }, { name: 'N/A', perc: 0 });
                
                const worstAttendance = subjects.reduce((worst, s) => {
                    if (s.total === 0) return worst;
                    const perc = (s.attended / s.total) * 100;
                    return perc < worst.perc ? { name: s.name, perc } : worst;
                }, { name: 'N/A', perc: 100 });
                
                const totalSkips = subjects.reduce((sum, s) => sum + s.skipsUsed, 0);
                const bestStreak = subjects.reduce((max, s) => Math.max(max, s.bestStreak), 0);
                
                const atRisk = subjects.filter(s => {
                    if (s.total === 0) return false;
                    const perc = (s.attended / s.total) * 100;
                    return perc < 80;
                }).length;
                
                const analyticsGrid = document.getElementById('analyticsGrid');
                analyticsGrid.innerHTML = `
                    <div class="analytics-card">
                        <h3>üèÜ Best Attendance</h3>
                        <div class="value">${bestAttendance.perc.toFixed(1)}%</div>
                        <p>${bestAttendance.name}</p>
                    </div>
                    <div class="analytics-card">
                        <h3>üìâ Needs Attention</h3>
                        <div class="value">${worstAttendance.perc.toFixed(1)}%</div>
                        <p>${worstAttendance.name}</p>
                    </div>
                    <div class="analytics-card">
                        <h3>‚è≠Ô∏è Total Skips</h3>
                        <div class="value">${totalSkips}</div>
                        <p>Classes missed</p>
                    </div>
                    <div class="analytics-card">
                        <h3>üî• Best Streak</h3>
                        <div class="value">${bestStreak}</div>
                        <p>Consecutive days</p>
                    </div>
                    <div class="analytics-card">
                        <h3>‚ö†Ô∏è At Risk</h3>
                        <div class="value">${atRisk}</div>
                        <p>Subject(s) below 80%</p>
                    </div>
                `;
            }
        }

        const app = new SkipSmart();
    </script>
</body>
</html>